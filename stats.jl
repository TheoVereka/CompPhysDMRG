using Plots;
using JLD2;

##
N42Jn1h0dim200_sweepsVStime1=[0.079,0.735,2.492,4.665,4.892,4.785,4.616,4.677,4.390,4.508,4.222,3.904,3.749,3.509,2.901,2.917,2.710,2.497,1.875,1.971];
N42Jn1h0dim200_sweepsVStime2=[0.087,0.779,2.533,4.035,4.092,4.055,3.869,3.636,3.564,3.430,3.225,3.301,3.163,2.810,3.154,2.565,2.761,2.520,2.551];

N42Jn1h0dim200_sweepsVSenergy1=[-10.1654514849, -10.2200684702, -10.2337089730, -10.2394794463, -10.2424342589, -10.2443135096, -10.2456166656, -10.2465543438, -10.2473018017, -10.247881545, -10.248315541, -10.248648208, -10.248916219, -10.249151366, -10.249337062, -10.249479733, -10.249592664, -10.249674185, -10.249744077, -10.249797310];
N42Jn1h0dim200_sweepsVSenergy2=[-10.1797996,-10.2218073,-10.2311193,-10.2352465,-10.2376858,-10.2394460,-10.2407372,-10.2417913,-10.2427959,-10.243632,-10.244336,-10.244960,-10.245545,-10.246061,-10.246509,-10.246913,-10.247290,-10.247655,-10.247975];



##
N42Jn1h0sweep20_dims=[3,5,8,11,15,19,23,28,34,40,47,55,64,77,95,105,130,160,200]

N42Jn1h0sweep20_dimsVStotalTime_s=[0.375065,0.447897, 0.609250,0.659843,1.022270,1.572686,1.900692,3.494330,3.866977,5.059274,6.519335,8.920954,12.050059,11.316273,22.917435,24.513504,36.400076,54.744795,70.208285];
N42Jn1h0sweep20_dimsVSallocatedMemory_GiB=[0.687,0.776,0.981,1.238 ,1.743 ,2.372 ,3.104 ,4.232 ,5.835 ,7.661 ,9.955 ,13.394,17.166,16.667,33.188,36.706,56.324,82.992,106.15];
N42Jn1h0sweep20_dimsVSfinalEnergy=[-10.249997, -10.249999,-10.249999,-10.249987,-10.249202,-10.249927,-10.249537,-10.249488,-10.249014,-10.249630,-10.244805,-10.248955,-10.248515,-10.249955,-10.248223,-10.249894,-10.249584,-10.248530,-10.248961];

N42J1h0sweep20_dimsVStotalTime_s=[0.369479, 0.488179, 0.567944, 0.652764, 0.877320, 1.517440,  1.895362,  3.558572,  4.025269,  4.929708,  6.665049,  8.945587, 12.073862, 15.522123, 19.042522, 19.188805, 19.475981, 20.417283, 18.938900];
N42J1h0sweep20_dimsVSallocatedMemory_GiB=[0.687,0.776,0.979,1.238 ,1.743,2.373,3.125,4.258 ,5.876 ,7.714,10.096,13.151,16.961,22.282,28.103,28.617,28.856,30.878,28.707];
N42J1h0sweep20_dimsVSfinalEnergy=[-18.080422227918096,-18.37237711880419,-18.423619939419044,-18.4261472593908,-18.42717672461878,-18.427513074860222,-18.42755835486145,-18.42756631069586,-18.427569335413445,-18.42757033952288,-18.427570465820637,-18.427570489613647,-18.427570498018852,-18.427570500022995,-18.42757050036157,-18.427570500367978,-18.427570500368038,-18.427570500368013,-18.427570500368134];


##
Jn1h0sweep10dim100_Nsites=[3,5,7,10,13,17,21,26,31,37,43,50,58,67,78,89,100,115,132,150];

Jn1h0sweep10dim100_NsitesVStotalTime_s=[ 0.015527,0.026337,0.032879,0.072181,0.287537,0.977319,3.438793,5.226094,7.160582,10.022806,12.263039,13.831658,18.602673,22.126155,22.263500,30.789424,30.157086,40.658074,46.365459,54.597199];
Jn1h0sweep10dim100_NsitesVSallocatedMemory_GiB=[ 0.007,0.028,0.048,0.126,0.513, 1.546,5.249,8.337,11.098 ,14.869 ,18.620,21.118 ,27.785 ,33.360 ,34.478 ,46.303,45.732 ,61.221,69.520 ,82.695 ];



##







##
N42sweep10dim100_h = 0.01:0.11:2.00
N42sweep10dim100_J = -2:0.15:1.5
phaseDia=[];
push!(phaseDia,Array(load_object("avgMz_N42sweep10dim100,try1745.jld2")));
push!(phaseDia,Array(load_object("energy_N42sweep10dim100,try1745.jld2")));
push!(phaseDia,Array(load_object("maxSvn_N42sweep10dim100,try1745.jld2")));
for i = 1:3
    phaseDia[i]=transpose(reshape(phaseDia[i],(length(N42sweep10dim100_J),length(N42sweep10dim100_h))))
end


##
heatmap(N42sweep10dim100_J,N42sweep10dim100_h,phaseDia[1],c=cgrad(:curl, rev=false),title="Average magnetization over spin chain (Î¼_B)",xlabel="J (energy unit)",ylabel="h (energy unit)") #clim,xticks


##
heatmap(N42sweep10dim100_J,N42sweep10dim100_h,phaseDia[2]/42,c=cgrad(:deep, rev=true),title="Energy of the DMRG ground state (energy unit)",xlabel="J (energy unit)",ylabel="h (energy unit)",clim=(-1.5,-0.25),xlim=(-2,1.5),ylim=(0,2)) #clim,xticks


##
heatmap(N42sweep10dim100_J,N42sweep10dim100_h,phaseDia[3]/log(2),c=cgrad(:magma, rev=false),title="Maximum bipartite entropy of entanglement (bit)",xlabel="J (energy unit)",ylabel="h (energy unit)") #clim,xticks

